!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define("Pictool.core.digit.transform",r):((t=t||self).Pictool=t.Pictool||{},t.Pictool.core=t.Pictool.core||{},t.Pictool.core.digit=t.Pictool.core.digit||{},t.Pictool.core.digit.transform=r())}(this,function(){"use strict";function g(t){var r=t.h/360,a=t.s/100,o=t.l/100,n=0,e=0,i=0;if(0==a)i=e=n=function(t){var r=t*d;return r=Math.round(r),r=Math.max(0,r),r=Math.min(255,r)}(o);else{var c=[],h=.5<=o?o+a-o*a:o*(1+a),f=2*o-h;c[0]=r+1/3,c[1]=r,c[2]=r-1/3;for(var u=0;u<c.length;u++){var l=c[u];switch(l<0?l+=1:1<l&&(l-=1),!0){case l<1/6:l=f+6*(h-f)*l;break;case 1/6<=l&&l<.5:l=h;break;case.5<=l&&l<2/3:l=f+(h-f)*(4-6*l);break;default:l=f}c[u]=Math.round(l*d)}n=c[0],e=c[1],i=c[2]}return{r:n,g:e,b:i}}function m(t){return 100*t/d}var v=function(){return(v=Object.assign||function(t){for(var r,a=1,o=arguments.length;a<o;a++)for(var n in r=arguments[a])Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t}).apply(this,arguments)},d=255;function M(t){return-100<=t&&t<=100}function p(t,r){var a=t.r,o=t.g,n=t.b,e=m(a),i=m(o),c=m(n),h=Math.min(e,i,c),f=Math.max(e,i,c),u=f-h,l=0,d=0,s=(f+h)/2;return f===h?d=l=0:(f===e&&c<=i?l=(i-c)/u*60+0:f===e&&i<c?l=(i-c)/u*60+360:f===i?l=(c-e)/u*60+120:f===c&&(l=(e-i)/u*60+240),0===s||f===h?d=0:0<s&&s<=127.5?d=u/(f+h):127.5<s&&(d=u/(510-(f+h)))),l=Math.round(l),d=Math.round(100*d),s=Math.round(s),r&&(M(r.h)&&(l=Math.floor(l*(100+r.h)/100),l=Math.min(360,l),l=Math.max(0,l)),M(r.s)&&(d=Math.floor(d*(100+r.s)/100),d=Math.min(100,d),d=Math.max(0,d)),M(r.l)&&(s=Math.floor(s*(100+r.l)/100),s=Math.min(100,s),s=Math.max(0,s))),{h:l,s:d,l:s}}return{HSL2RGB:g,RGB2HSL:p,transformImageData:function(t,r){for(var a=t.data,o=t.width,n=t.height,e=r.percent,i=void 0===e?{}:e,c=new ImageData(o,n),h=0;h<a.length;h+=4){var f=a[h],u=a[h+1],l=a[h+2],d=a[h+3],s=p({r:f,g:u,b:l},i),m=v({},s),M=g(m);c.data[h]=M.r,c.data[h+1]=M.g,c.data[h+2]=M.b,c.data[h+3]=d}return c}}});
