<html lang="zh-CN">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <style>
    img {
      max-height: 200px;
      min-width: 100px;
    }
    </style>
  </head>
  <body>

    <div>
      <img src="./../image/pexels-photo-005.jpg" />
    </div>
    <br/>
    <div id="display">
      <img />
    </div>

    <script src="./../../dist/browser-util.js"></script>
    <script src="./../../dist/digit.js"></script>
    <script>
    (function() {
      // 测试图片来自 www.pexels.com
      // test photo from www.pexels.com

      var browserUtil = Pictool.browserUtil;
      var digit = Pictool.digit;

      var src = './../image/pexels-photo-005.jpg';
      browserUtil.getImageBySrc(src).then(function(originImg) {
        var targetImgSrc = browserUtil.compressImage(originImg);
        
        browserUtil.getImageDataBySrc(targetImgSrc).then(function(targetImgData) {
        

          var rsData = digit.process.saturation(targetImgData, { percent: -60 });
          var imgData = browserUtil.digitImageData2ImageData(rsData);

          const tempData = {
            width: imgData.width,
            height: imgData.height,
            data: [],
          }
          for(let i = 0; i < imgData.data.length; i++) {
            tempData.data.push(imgData.data[i])
          }
          console.log(JSON.stringify(tempData));

          rsData.destory();
          rsData = null;

          var base64 = browserUtil.imageData2Base64(imgData);
          document.querySelector('#display').innerHTML = `
            <img src="${base64}" />
          `;

        }).catch(function(err) {
          console.log(err);
        });
      }).catch(function(err) {
        console.log(err);
      })
    })();
    </script>
  </body>
</html>